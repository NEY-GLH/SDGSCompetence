<div class="well bs-component">

    <legend>{{ text }}</legend>

<div class="form-group">
    <label class="col-lg-2 control-label"></label>
    <div class="col-lg-10">
        {{ table }}
    </div>
</div>

<div class="form-group">
    <label class="col-lg-2 control-label"></label>
    <div class="col-lg-10">
        <a href="#" class="btn btn-primary pull-right" id="add_subsection_{{ val }}"><span
                class="glyphicon glyphicon-plus-sign"></span> Add</a>

    </div>
</div>
<div class="form-group" id="subsection_form_{{ val }}" hidden>
    <label class="col-lg-2 control-label"></label>
     <div class="col-lg-10">
         <div class="form-group">
                            {{ subsection_form.name.label(class_="col-lg-2 control-label") }}
                            <div class="col-lg-10">
                                {{ subsection_form.name(class_="form-control name_"+val) }}
                            </div>
          </div>
          <div class="form-group">
                            {{ subsection_form.evidence.label(class_="col-lg-2 control-label") }}
                            <div class="col-lg-10">
                                {{ subsection_form.evidence(class_="form-control evidence_"+val) }}
                            </div>
          </div>
         <div class="form-group">
                            {{ subsection_form.comments.label(class_="col-lg-2 control-label") }}
                            <div class="col-lg-10">
                                {{ subsection_form.comments(class_="form-control comments_"+val) }}
                            </div>
         </div>
         <button class="btn btn-primary" id="submit_subsection_{{ val }}" type="button">Add Subsection</button>

     </div>
</div>
    </div>

    <script>
        $("#add_subsection_{{ val }}").click(function (e) {
            e.preventDefault();
            $('#subsection_form_{{ val }}').show()
        });

        $("#submit_subsection_{{ val }}").click(function (e) {
            e.preventDefault();
            var dict = {'name': $(".name_{{ val }}").val(), 'evidence_id':  $(".evidence_{{ val }}").val(), 'comments':$(".comments_{{ val }}").val(), 'c_id':{{ c_id }}, 's_id':{{  val }}};
            var data = JSON.stringify(dict);
            console.log(dict)

            $.ajax({
                type: "POST",
                url: "{{ url_for('competence.add_sections_to_db',id=val) }}",
                data: data,
                dataType: "json",
                contentType: "application/json",
                success: function (response) {

                    $('.section_{{ val }}').replaceWith(response);
                },
                error: function (xhr, status, error) {
                    $('#trace').append("<p>" + error + "</p>");
                    $('#ajaxModal').modal('show');
                    return false;
                }

            });
        });

    </script>